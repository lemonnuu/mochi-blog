<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Nginx</title>
    <meta name="description" content="Mochi's personal blog.">
    <link rel="preload stylesheet" href="/mochi-blog/assets/style.c5715627.css" as="style">
    <link rel="modulepreload" href="/mochi-blog/assets/chunks/VPAlgoliaSearchBox.7a447316.js">
    <link rel="modulepreload" href="/mochi-blog/assets/chunks/symbol.3b47a695.js">
    <link rel="modulepreload" href="/mochi-blog/assets/app.d83c26ff.js">
    <link rel="modulepreload" href="/mochi-blog/assets/POSTS_node_004_nginx.md.bc217569.lean.js">
    
    <script id="check-dark-light">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
  </head>
  <body>
    <div id="app"><!--[--><div class="sidebar-nav-toggle" style="--117a3cb0:#242424;--f8185b16:#ffffff;" data-v-9314ca4e><svg class="icon-font icon-arrow" aria-hidden="true" data-v-9314ca4e><use xlink:href="#icon-left-arrow" data-v-9314ca4e></use></svg></div><div class="Layout" style="--117a3cb0:#242424;--f8185b16:#ffffff;" data-v-9314ca4e data-v-2f5187ef><!--[--><!--]--><!--[--><span tabindex="-1" data-v-d053d77d></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-d053d77d> Skip to content </a><!--]--><!----><header class="VPNav no-sidebar" data-v-2f5187ef data-v-1f1b5af5><div class="VPNavBar" data-v-1f1b5af5 data-v-9b1f2697><div class="container" data-v-9b1f2697><div class="VPNavBarTitle" data-v-9b1f2697 data-v-aa73a246><a class="title" href="/mochi-blog/" data-v-aa73a246><!--[--><!--]--><!--[--><!--[--><!--[--><img class="VPImage dark logo" src="/mochi-blog/logo-dark.svg" alt data-v-57b33494><!--]--><!--[--><img class="VPImage light logo" src="/mochi-blog/logo-light.svg" alt data-v-57b33494><!--]--><!--]--><!--]--><!----><!--[--><!--]--></a></div><div class="content" data-v-9b1f2697><!--[--><!--]--><div class="VPNavBarSearch search" data-v-9b1f2697 style="--4c44fa30:&#39;Meta&#39;;"><div id="docsearch"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg class="DocSearch-Search-Icon" width="20" height="20" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-9b1f2697 data-v-0477f96b><span id="main-nav-aria-label" class="visually-hidden" data-v-0477f96b>Main Navigation</span><!--[--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-0477f96b data-v-ddb35af0><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-ddb35af0><span class="text" data-v-ddb35af0><!----> Notes <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-ddb35af0><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-ddb35af0><div class="VPMenu" data-v-ddb35af0 data-v-4a3eaef0><div class="items" data-v-4a3eaef0><!--[--><!--[--><div class="VPMenuLink" data-v-4a3eaef0 data-v-047fc2b1><a class="VPLink link" href="/mochi-blog/_NOTES/Build%20Tools/rollup/01_pre.html" data-v-047fc2b1 data-v-bcac21e9><!--[-->Build Tools<!--]--><!----></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-0477f96b data-v-ddb35af0><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-ddb35af0><span class="text" data-v-ddb35af0><!----> Posts <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-ddb35af0><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-ddb35af0><div class="VPMenu" data-v-ddb35af0 data-v-4a3eaef0><div class="items" data-v-4a3eaef0><!--[--><!--[--><div class="VPMenuLink" data-v-4a3eaef0 data-v-047fc2b1><a class="VPLink link" href="/mochi-blog/timeline.html" data-v-047fc2b1 data-v-bcac21e9><!--[-->Timeline<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-4a3eaef0 data-v-047fc2b1><a class="VPLink link" href="/mochi-blog/category.html" data-v-047fc2b1 data-v-bcac21e9><!--[-->Categories<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-4a3eaef0 data-v-047fc2b1><a class="VPLink link" href="/mochi-blog/tag.html" data-v-047fc2b1 data-v-bcac21e9><!--[-->Tags<!--]--><!----></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-9b1f2697 data-v-69ca162b><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" aria-checked="false" data-v-69ca162b data-v-344adc65 data-v-fc48a6d9><span class="check" data-v-fc48a6d9><span class="icon" data-v-fc48a6d9><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-344adc65><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-344adc65><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-9b1f2697 data-v-ca5eb9c8 data-v-238b06a8><!--[--><a class="VPSocialLink" href="https://github.com/lemonnuu" target="_blank" rel="noopener" data-v-238b06a8 data-v-ab654f60><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-9b1f2697 data-v-3401da01 data-v-ddb35af0><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-ddb35af0><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-ddb35af0><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-ddb35af0><div class="VPMenu" data-v-ddb35af0 data-v-4a3eaef0><!----><!--[--><!--[--><!----><div class="group" data-v-3401da01><div class="item appearance" data-v-3401da01><p class="label" data-v-3401da01>Appearance</p><div class="appearance-action" data-v-3401da01><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" aria-checked="false" data-v-3401da01 data-v-344adc65 data-v-fc48a6d9><span class="check" data-v-fc48a6d9><span class="icon" data-v-fc48a6d9><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-344adc65><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-344adc65><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><div class="group" data-v-3401da01><div class="item social-links" data-v-3401da01><div class="VPSocialLinks social-links-list" data-v-3401da01 data-v-238b06a8><!--[--><a class="VPSocialLink" href="https://github.com/lemonnuu" target="_blank" rel="noopener" data-v-238b06a8 data-v-ab654f60><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-9b1f2697 data-v-02959e0f><span class="container" data-v-02959e0f><span class="top" data-v-02959e0f></span><span class="middle" data-v-02959e0f></span><span class="bottom" data-v-02959e0f></span></span></button></div></div></div><!----></header><!----><!----><div class="VPContent" id="VPContent" data-v-2f5187ef data-v-6edf2abd><div class="VPDoc has-aside" data-v-6edf2abd data-v-b6472854><div class="container" data-v-b6472854><div class="aside" data-v-b6472854><div class="aside-curtain" data-v-b6472854></div><div class="aside-container" data-v-b6472854><div class="aside-content" data-v-b6472854><div class="VPDocAside" data-v-b6472854 data-v-772dce49><!--[--><!--[--><!--[--><!--[--><div class="show-eyes aside-top" data-v-9314ca4e><svg class="icon-font icon-eye" aria-hidden="true" data-v-9314ca4e><use xlink:href="#icon-close-eyes" data-v-9314ca4e></use></svg></div><!--]--><!--]--><!--]--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" data-v-772dce49 data-v-d36b5956><div class="content" data-v-d36b5956><div class="outline-marker" data-v-d36b5956></div><div class="outline-title" data-v-d36b5956>大纲</div><nav aria-labelledby="doc-outline-aria-label" data-v-d36b5956><span class="visually-hidden" id="doc-outline-aria-label" data-v-d36b5956> Table of Contents for current page </span><ul class="root" data-v-d36b5956 data-v-0cff718e><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-772dce49></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-b6472854><div class="content-container" data-v-b6472854><!--[--><!--]--><main class="main" data-v-b6472854><div style="position:relative;" class="vp-doc _mochi-blog__POSTS_node_004_nginx" data-v-b6472854><div><h1 id="nginx" tabindex="-1">Nginx <a class="header-anchor" href="#nginx" aria-hidden="true">#</a></h1><p><a href="https://nginx.org/en/docs/" target="_blank" rel="noreferrer">Nginx</a> 是一款轻量级的 Web 服务器、反向代理服务器，由于它的内存占用少, 启动极快, 高并发能力强, 在互联网项目中广泛应用。</p><h2 id="安装" tabindex="-1">安装 <a class="header-anchor" href="#安装" aria-hidden="true">#</a></h2><p><a href="https://nginx.org/en/linux_packages.html#Ubuntu" target="_blank" rel="noreferrer">Ubuntu 安装 Nginx</a> 可以不像官网描述的这么复杂, 直接执行以下命令即可。</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">sudo</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">apt-get</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">update</span></span>
<span class="line"><span style="color:#FFCB6B;">sudo</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">apt-get</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nginx</span></span>
<span class="line"></span></code></pre></div><p>两者唯一的区别是官网安装的是最新版的 Nginx, 而上面命令安装的是 1.18.0 特定版本。但由于 Nginx 非常稳定, 版本相差不大也不要紧。</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">nginx</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-v</span></span>
<span class="line"></span></code></pre></div><p>安装结束后执行 <code>nginx -v</code> 出现相应版本号即表示安装成功。</p><h2 id="文件" tabindex="-1">文件 <a class="header-anchor" href="#文件" aria-hidden="true">#</a></h2><h3 id="nginx-可执行脚本存放位置" tabindex="-1">Nginx 可执行脚本存放位置 <a class="header-anchor" href="#nginx-可执行脚本存放位置" aria-hidden="true">#</a></h3><p>nginx 的可执行脚本存放在 /usr/share/nginx/ 目录里面, 一般不需要操作此文件夹。</p><h3 id="配置文件" tabindex="-1">配置文件 <a class="header-anchor" href="#配置文件" aria-hidden="true">#</a></h3><p>nginx 的配置文件存放在 /etc/nginx/ 目录里面。</p><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-DGlUc" id="tab-rPledI0" checked="checked"><label for="tab-rPledI0">执行脚本</label><input type="radio" name="group-DGlUc" id="tab-tAnOlaO"><label for="tab-tAnOlaO">示例</label></div><div class="blocks"><div class="language-shell active"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#82AAFF;">cd</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/etc/nginx/</span></span>
<span class="line"><span style="color:#FFCB6B;">ls</span></span>
<span class="line"></span></code></pre></div><div class="language-text"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#A6ACCD;">root@mochi:~# cd /etc/nginx</span></span>
<span class="line"><span style="color:#A6ACCD;">root@mochi:/etc/nginx# ls</span></span>
<span class="line"><span style="color:#A6ACCD;">conf.d        fastcgi_params  koi-win     modules-available  nginx.conf    scgi_params      sites-enabled  uwsgi_params</span></span>
<span class="line"><span style="color:#A6ACCD;">fastcgi.conf  koi-utf         mime.types  modules-enabled    proxy_params  sites-available  snippets       win-utf</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div></div></div><ul><li>nginx.conf : 配置文件, 其中引入了 sites-available 目录下的所有文件</li><li>sites-available : 包含 default 配置文件, 一般就是更改 default 文件</li></ul><h3 id="日志文件" tabindex="-1">日志文件 <a class="header-anchor" href="#日志文件" aria-hidden="true">#</a></h3><p>日志文件存放在 /var/log/nginx 文件夹下。</p><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-d_RyE" id="tab-Emgzt5N" checked="checked"><label for="tab-Emgzt5N">执行脚本</label><input type="radio" name="group-d_RyE" id="tab-Dj_OApw"><label for="tab-Dj_OApw">示例</label></div><div class="blocks"><div class="language-shell active"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#82AAFF;">cd</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/var/log/nginx</span></span>
<span class="line"><span style="color:#FFCB6B;">ls</span></span>
<span class="line"></span></code></pre></div><div class="language-text"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#A6ACCD;">root@mochi:~# cd /var/log/nginx</span></span>
<span class="line"><span style="color:#A6ACCD;">root@mochi:/var/log/nginx# ls</span></span>
<span class="line"><span style="color:#A6ACCD;">access.log  error.log</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div></div></div><ul><li>access.log : 请求日志</li><li>error.log : 错误日志</li></ul><h2 id="常用命令" tabindex="-1">常用命令 <a class="header-anchor" href="#常用命令" aria-hidden="true">#</a></h2><h3 id="查看-80-端口占用情况" tabindex="-1">查看 80 端口占用情况 <a class="header-anchor" href="#查看-80-端口占用情况" aria-hidden="true">#</a></h3><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">netstat</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-tupln</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">grep</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">80</span></span>
<span class="line"></span></code></pre></div><h3 id="停止" tabindex="-1">停止 <a class="header-anchor" href="#停止" aria-hidden="true">#</a></h3><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-z6egN" id="tab-XvOSzmt" checked="checked"><label for="tab-XvOSzmt">强制停止</label><input type="radio" name="group-z6egN" id="tab-40A9IpQ"><label for="tab-40A9IpQ">退出</label></div><div class="blocks"><div class="language-shell active"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">nginx</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-s</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">stop</span></span>
<span class="line"></span></code></pre></div><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">nginx</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-s</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">quit</span></span>
<span class="line"></span></code></pre></div></div></div><p>stop 与 quit 的区别就是 stop 会立即停止 nginx, 而 quit 会等子进程处理完毕再停止, 但不接收新的请求。</p><h3 id="开启" tabindex="-1">开启 <a class="header-anchor" href="#开启" aria-hidden="true">#</a></h3><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">nginx</span></span>
<span class="line"></span></code></pre></div><h3 id="重启" tabindex="-1">重启 <a class="header-anchor" href="#重启" aria-hidden="true">#</a></h3><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">nginx</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-s</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">reload</span></span>
<span class="line"></span></code></pre></div><h3 id="重新加载磁盘位置" tabindex="-1">重新加载磁盘位置 <a class="header-anchor" href="#重新加载磁盘位置" aria-hidden="true">#</a></h3><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">nginx</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-s</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">reopen</span></span>
<span class="line"></span></code></pre></div><p>nginx 日志文件的存取是基于磁盘位置的, 也就是说即使将 access.log 重命名为 test.log, nginx 仍然会将日志文件写入 test.log。</p><p>reopen 命令可以让 nginx 重新获取磁盘位置, 写入新创建的 access.log 中。</p><h3 id="检测配置文件是否有语法错误" tabindex="-1">检测配置文件是否有语法错误 <a class="header-anchor" href="#检测配置文件是否有语法错误" aria-hidden="true">#</a></h3><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">nginx</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-t</span></span>
<span class="line"></span></code></pre></div><h3 id="查看所有命令" tabindex="-1">查看所有命令 <a class="header-anchor" href="#查看所有命令" aria-hidden="true">#</a></h3><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">nginx</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-h</span></span>
<span class="line"></span></code></pre></div><h2 id="配置" tabindex="-1">配置 <a class="header-anchor" href="#配置" aria-hidden="true">#</a></h2><h3 id="配置规则" tabindex="-1">配置规则 <a class="header-anchor" href="#配置规则" aria-hidden="true">#</a></h3><p>打开 /etc/nginx/nginx.conf 文件, 其内容可大致分为几个区域。</p><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-v3FrW" id="tab-lilELSt" checked="checked"><label for="tab-lilELSt">nginx.conf</label><input type="radio" name="group-v3FrW" id="tab-IBzusp-"><label for="tab-IBzusp-">配置规则</label><input type="radio" name="group-v3FrW" id="tab-5JOa5Wl"><label for="tab-5JOa5Wl">nginx.conf 示例</label></div><div class="blocks"><div class="language-shell active"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#82AAFF;">cd</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/etc/nginx</span></span>
<span class="line"><span style="color:#FFCB6B;">vi</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nginx.conf</span></span>
<span class="line"></span></code></pre></div><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">Main</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">#全局配置区</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">events</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;"># events 事件区, 子进程核心配置</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">http</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;"># http 服务器配置区</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">server</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;"># 不同服务配置区</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">location</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;"># location 不同请求路径配置区</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#676E95;font-style:italic;"># 具体配置选项</span></span>
<span class="line"><span style="color:#A6ACCD;">    }</span></span>
<span class="line"><span style="color:#A6ACCD;">  }</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">mail</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;"># 邮件代理配置区</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">server</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;"># 邮件服务配置区</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;"># 具体配置选项</span></span>
<span class="line"><span style="color:#A6ACCD;">  }</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"></span></code></pre></div><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">user</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">www-data</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#FFCB6B;">worker_processes</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">auto</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#FFCB6B;">pid</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/run/nginx.pid</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#FFCB6B;">include</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/etc/nginx/modules-enabled/</span><span style="color:#A6ACCD;">*</span><span style="color:#C3E88D;">.conf</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">events</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#FFCB6B;">worker_connections</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">768</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;"># multi_accept on;</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">http</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;">##</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;"># Basic Settings</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;">##</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#FFCB6B;">sendfile</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">on</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#FFCB6B;">tcp_nopush</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">on</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#FFCB6B;">types_hash_max_size</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2048</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;"># server_tokens off;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;"># server_names_hash_bucket_size 64;</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;"># server_name_in_redirect off;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#FFCB6B;">include</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/etc/nginx/mime.types</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#FFCB6B;">default_type</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">application/octet-stream</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;">##</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;"># SSL Settings</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;">##</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#FFCB6B;">ssl_protocols</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">TLSv1</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">TLSv1.</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">TLSv1.</span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">TLSv1.</span><span style="color:#F78C6C;">3</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;"># Dropping SSLv3, ref: POODLE</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#FFCB6B;">ssl_prefer_server_ciphers</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">on</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;">##</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;"># Logging Settings</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;">##</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#FFCB6B;">access_log</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/var/log/nginx/access.log</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#FFCB6B;">error_log</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/var/log/nginx/error.log</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;">##</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;"># Gzip Settings</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;">##</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#FFCB6B;">gzip</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">on</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;"># gzip_vary on;</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;"># gzip_proxied any;</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;"># gzip_comp_level 6;</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;"># gzip_buffers 16 8k;</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;"># gzip_http_version 1.1;</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;"># gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;">##</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;"># Virtual Host Configs</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;">##</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#FFCB6B;">include</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/etc/nginx/conf.d/</span><span style="color:#A6ACCD;">*</span><span style="color:#C3E88D;">.conf</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#FFCB6B;">include</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/etc/nginx/sites-enabled/</span><span style="color:#A6ACCD;">*</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#mail {</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#	# See sample authentication script at:</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#	# http://wiki.nginx.org/ImapAuthenticateWithApachePhpScript</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#	# auth_http localhost/auth.php;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#	# pop3_capabilities &quot;TOP&quot; &quot;USER&quot;;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#	# imap_capabilities &quot;IMAP4rev1&quot; &quot;UIDPLUS&quot;;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#	server {</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#		listen     localhost:110;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#		protocol   pop3;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#		proxy      on;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#	}</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#	server {</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#		listen     localhost:143;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#		protocol   imap;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#		proxy      on;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#	}</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#}</span></span>
<span class="line"></span></code></pre></div></div></div><p>其中 nginx.conf 又引入了 /etc/nginx/sites-enabled/*, 而我们实际需要配置的就是 /etc/nginx/sites-enabled/default 文件。</p><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-a6RhZ" id="tab-YU53cX9" checked="checked"><label for="tab-YU53cX9">default</label><input type="radio" name="group-a6RhZ" id="tab-cCXF7NH"><label for="tab-cCXF7NH">default 示例</label></div><div class="blocks"><div class="language-shell active"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#82AAFF;">cd</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/etc/nginx/sites-enabled</span></span>
<span class="line"><span style="color:#FFCB6B;">vi</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">default</span></span>
<span class="line"></span></code></pre></div><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-palenight has-diff"><code><span class="line"><span style="color:#676E95;font-style:italic;">##</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># You should look at the following URL&#39;s in order to grasp a solid understanding</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># of Nginx configuration files in order to fully unleash the power of Nginx.</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># https://www.nginx.com/resources/wiki/start/</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># https://www.nginx.com/resources/wiki/start/topics/tutorials/config_pitfalls/</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># https://wiki.debian.org/Nginx/DirectoryStructure</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># In most cases, administrators will remove this file from sites-enabled/ and</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># leave it as reference inside of sites-available where it will continue to be</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># updated by the nginx packaging team.</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># This file will automatically load configuration files provided by other</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># applications, such as Drupal or Wordpress. These applications will be made</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># available underneath a path with that package name, such as /drupal8.</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Please see /usr/share/doc/nginx-doc/examples/ for more detailed examples.</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">##</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Default server configuration</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#</span></span>
<span class="line"><span style="color:#FFCB6B;">server</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#FFCB6B;">listen</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">80</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">default_server</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#FFCB6B;">listen</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">::</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;">:80 </span><span style="color:#C3E88D;">default_server</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;"># SSL configuration</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;">#</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;"># listen 443 ssl default_server;</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;"># listen [::]:443 ssl default_server;</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;">#</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;"># Note: You should disable gzip for SSL traffic.</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;"># See: https://bugs.debian.org/773332</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;">#</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;"># Read up on ssl_ciphers to ensure a secure configuration.</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;"># See: https://bugs.debian.org/765782</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;">#</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;"># Self signed certs generated by the ssl-cert package</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;"># Don&#39;t use them in a production server!</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;">#</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;"># include snippets/snakeoil.conf;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#FFCB6B;">root</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/var/www/html</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;"># Add index.php to the list if you are using PHP</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#FFCB6B;">index</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">index.html</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">index.htm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">index.nginx-debian.html</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#FFCB6B;">server_name</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">_</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#FFCB6B;">location</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">		</span><span style="color:#676E95;font-style:italic;"># First attempt to serve request as file, then</span></span>
<span class="line"><span style="color:#A6ACCD;">		</span><span style="color:#676E95;font-style:italic;"># as directory, then fall back to displaying a 404.</span></span>
<span class="line"><span style="color:#A6ACCD;">		</span><span style="color:#FFCB6B;">try_files</span><span style="color:#A6ACCD;"> $uri $uri</span><span style="color:#C3E88D;">/</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">=</span><span style="color:#F78C6C;">404</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;"># pass PHP scripts to FastCGI server</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;">#</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;">#location ~ \.php$ {</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;">#	include snippets/fastcgi-php.conf;</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;">#</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;">#	# With php-fpm (or other unix sockets):</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;">#	fastcgi_pass unix:/run/php/php7.4-fpm.sock;</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;">#	# With php-cgi (or other tcp sockets):</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;">#	fastcgi_pass 127.0.0.1:9000;</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;">#}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;"># deny access to .htaccess files, if Apache&#39;s document root</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;"># concurs with nginx&#39;s one</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;">#</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;">#location ~ /\.ht {</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;">#	deny all;</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;">#}</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Virtual Host configuration for example.com</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># You can move that to a different file under sites-available/ and symlink that</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># to sites-enabled/ to enable it.</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#server {</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#	listen 80;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#	listen [::]:80;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#	server_name example.com;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#	root /var/www/example.com;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#	index index.html;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#	location / {</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#		try_files $uri $uri/ =404;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#	}</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#}</span></span>
<span class="line"></span></code></pre></div></div></div><h3 id="配置-https-安全协议" tabindex="-1">配置 HTTPS 安全协议 <a class="header-anchor" href="#配置-https-安全协议" aria-hidden="true">#</a></h3><p>首先得去阿里云获取免费的 SSL 证书并下载 nginx 的版本。</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">server</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;"># listen 80 default_server;</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#676E95;font-style:italic;"># listen [::]:80 default_server;</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#FFCB6B;">listen</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">443</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ssl</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#FFCB6B;">server_name</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">www.moyo.love</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;"># 域名, 需写全</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#FFCB6B;">ssl_certificate</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/etc/nginx/m.pem</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;"># 下载的证书</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#FFCB6B;">ssl_certificate_key</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/etc/nginx/m.key</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;"># 下载的密钥</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"></span></code></pre></div><h3 id="反向代理" tabindex="-1">反向代理 <a class="header-anchor" href="#反向代理" aria-hidden="true">#</a></h3><p>以 /api 开头的请求都会被 3000 端口接管处理。</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">server</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#FFCB6B;">location</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/api</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">		</span><span style="color:#FFCB6B;">proxy_pass</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">HTTP://127.0.0.1:</span><span style="color:#F78C6C;">3000</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">	}</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"></span></code></pre></div><h3 id="前端网站" tabindex="-1">前端网站 <a class="header-anchor" href="#前端网站" aria-hidden="true">#</a></h3><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">server</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#FFCB6B;">location</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/mochi-blog</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">		</span><span style="color:#82AAFF;">alias</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/mochi/mochi-blog/</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">		</span><span style="color:#676E95;font-style:italic;"># 这个 base 如果有子目录则填子目录, 否则不用填写</span></span>
<span class="line"><span style="color:#A6ACCD;">		</span><span style="color:#FFCB6B;">try_files</span><span style="color:#A6ACCD;"> $uri $uri</span><span style="color:#C3E88D;">/</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/base/index.html</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">	}</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"></span></code></pre></div></div></div></main><!--[--><!--]--><footer class="VPDocFooter" data-v-b6472854 data-v-de56c8ff><div class="edit-info" data-v-de56c8ff><div class="edit-link" data-v-de56c8ff><a class="VPLink link edit-link-button" href="https://github.com/lemonnuu/mochi-blog/blob/master/docs/_POSTS/node/004_nginx.md" target="_blank" rel="noreferrer" data-v-de56c8ff data-v-bcac21e9><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="edit-link-icon" data-v-de56c8ff><path d="M18,23H4c-1.7,0-3-1.3-3-3V6c0-1.7,1.3-3,3-3h7c0.6,0,1,0.4,1,1s-0.4,1-1,1H4C3.4,5,3,5.4,3,6v14c0,0.6,0.4,1,1,1h14c0.6,0,1-0.4,1-1v-7c0-0.6,0.4-1,1-1s1,0.4,1,1v7C21,21.7,19.7,23,18,23z"></path><path d="M8,17c-0.3,0-0.5-0.1-0.7-0.3C7,16.5,6.9,16.1,7,15.8l1-4c0-0.2,0.1-0.3,0.3-0.5l9.5-9.5c1.2-1.2,3.2-1.2,4.4,0c1.2,1.2,1.2,3.2,0,4.4l-9.5,9.5c-0.1,0.1-0.3,0.2-0.5,0.3l-4,1C8.2,17,8.1,17,8,17zM9.9,12.5l-0.5,2.1l2.1-0.5l9.3-9.3c0.4-0.4,0.4-1.1,0-1.6c-0.4-0.4-1.2-0.4-1.6,0l0,0L9.9,12.5z M18.5,2.5L18.5,2.5L18.5,2.5z"></path></svg> 编辑此页<!--]--><!----></a></div><div class="last-updated" data-v-de56c8ff><p class="VPLastUpdated" data-v-de56c8ff data-v-888ad67c>上次更新时间: <time datetime="2023-01-30T02:55:49.000Z" data-v-888ad67c></time></p></div></div><!----></footer><!--[--><!--]--></div></div></div></div></div><footer class="VPFooter" data-v-2f5187ef data-v-beef4280><div class="container" data-v-beef4280><p class="message" data-v-beef4280>Mochi's personal blog.</p><p class="copyright" data-v-beef4280>Copyright © 2021-present Mochi</p></div></footer><!--[--><div class="fixed top-0 left-0 z-[-1] opacity-10" data-v-9314ca4e><!----></div><div id="goTop" class="hide-cat" data-v-9314ca4e style="--28faecc8:0;--0a79e8e7:rgb(226, 90, 41);" data-v-8362060a></div><!--]--></div><!--]--></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"notes_build tools_rollup_index.md\":\"be552d94\",\"posts_node_006_pm2.md\":\"bfc72644\",\"notes_build tools_rollup_01_pre.md\":\"cb4d67fc\",\"posts_node_001_node-basic.md\":\"836c938f\",\"posts_node_004_nginx.md\":\"bc217569\",\"posts_vitepress_002_vitepress-theme-mochi.md\":\"d6498c85\",\"posts_javascript_001_special-value.md\":\"ecd367c1\",\"posts_node_007_mongodb.md\":\"99a6f595\",\"posts_node_005_koa-basic.md\":\"a0e2e44c\",\"projects_index.md\":\"07b4e925\",\"notes_build tools_rollup_02_use.md\":\"03508b3f\",\"posts_pits_001_deploy-gitpage-jekyll.md\":\"cfdb9ce9\",\"category.md\":\"374cca6e\",\"index.md\":\"806ac0ec\",\"timeline.md\":\"576ceed3\",\"posts_tips_002_judge-mobile.md\":\"f4b738c9\",\"posts_node_002_npm.md\":\"b5aea8e0\",\"tag.md\":\"1443a91f\",\"posts_tips_001_color-consolelog.md\":\"1ed27347\",\"notes_build tools_rollup_04_faqs.md\":\"e645a72f\",\"notes_build tools_esbuild_01_pre.md\":\"a23c31d1\",\"notes_build tools_esbuild_03_faqs.md\":\"85cf76a7\",\"posts_node_003_npx.md\":\"dc19e912\",\"posts_vitepress_003_algolia.md\":\"7501cbd4\",\"posts_vue_001-source-optimization.md\":\"192e2e3f\",\"origin.md\":\"70dc11f7\",\"posts_vitepress_001_vitepress.md\":\"92eb10c4\",\"notes_build tools_parcel_01_pre.md\":\"bdb4fd14\",\"notes_build tools_esbuild_index.md\":\"fe0b75b2\",\"notes_build tools_rollup_03_plugins.md\":\"e8439249\",\"posts_pits_002ubuntu-install-mongodb.md\":\"9ad09006\",\"notes_build tools_esbuild_02_use.md\":\"ff36c573\"}")</script>
    <script type="module" async src="/mochi-blog/assets/app.d83c26ff.js"></script>
    
  </body>
</html>